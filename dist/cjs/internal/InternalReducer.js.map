{"version":3,"file":"InternalReducer.js","names":["_lodash","_interopRequireDefault","require","_Reducer2","_excluded","e","__esModule","_typeof","o","Symbol","iterator","constructor","prototype","_objectWithoutProperties","t","r","i","_objectWithoutPropertiesLoose","Object","getOwnPropertySymbols","n","length","indexOf","propertyIsEnumerable","call","hasOwnProperty","_classCallCheck","a","TypeError","_defineProperties","enumerable","configurable","writable","defineProperty","_toPropertyKey","key","_createClass","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","apply","_assertThisInitialized","ReferenceError","Boolean","valueOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_inherits","create","value","_setPrototypeOf","_defineProperty","_toPrimitive","toPrimitive","String","Number","InternalReducer","_Reducer","_this","_len","arguments","args","Array","_key","concat","state","_ref","origin","payload","removeItem","action","match","actions","logAction","clearAction","router","routerEvent","resources","mapResource","_ref2","id","type","status","tracked","timestamp","className","_ref2$context","context","_ref2$context2","props","_ref3","pageNo","_","get","url","snakeCase","sort","order","search","resourceMap","compact","resourceId","resourceKey","join","actionIds","actionId","totalPages","pages","itemIds","_ref5","Reducer","_default","exports"],"sources":["../../../src/internal/InternalReducer.js"],"sourcesContent":["import _ from 'lodash';\nimport Reducer from '../Reducer';\n\nclass InternalReducer extends Reducer {\n\n  static applyEmbeddedReducer = false;\n\n  static initialState = {\n    actions: [],\n    router: [],\n    resources: {},\n  };\n\n  logAction(state, {\n    id,\n    type,\n    status,\n    origin,\n    tracked,\n    timestamp,\n    class: className,\n    context: { props, ...context } = {},\n  }) {\n    if (id && status && tracked) {\n      return [{ id, status, timestamp, className, origin, type, context }];\n    }\n  }\n\n  clearAction = (state, { payload: origin }) => this.removeItem(\n    (action) => (action.origin === origin),\n  );\n\n  mapResource(state, { payload }) {\n    const pageNo = _.get(payload, 'meta.currentPage');\n    const url = payload.url && _.snakeCase(payload.url);\n    const sort = payload.sort && _.snakeCase(payload.sort);\n    const order = payload.order && _.snakeCase(payload.order);\n    const search = payload.search && _.snakeCase(payload.search);\n    const resourceMap = _.compact([payload.resourceId, url, sort, order, search]);\n    const resourceKey = resourceMap.join('#');\n    if (pageNo) {\n      return {\n        [resourceKey]: {\n          actionIds: [payload.actionId],\n          totalPages: _.get(payload, 'meta.totalPages'),\n          pages: {\n            [pageNo]: {\n              itemIds: payload.itemIds,\n              timestamp: _.get(payload, 'meta.timestamp'),\n            },\n          },\n        },\n      };\n    }\n  }\n\n  routerEvent(state, { payload }) {\n    return payload;\n  }\n\n  state = this.match({\n    '.': {\n      actions: this.logAction,\n    },\n    '@@CLEAR_ACTION': {\n      actions: this.clearAction,\n    },\n    '@@ROUTER_EVENT': {\n      router: this.routerEvent,\n    },\n    '@@RESOURCE_CALL': {\n      resources: this.mapResource,\n    },\n  });\n\n}\n\nexport default InternalReducer;\n"],"mappings":"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","ignoreList":[]}